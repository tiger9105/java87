<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ArtistMapper">
  <!-- 
  <resultMap id="userSelectMap" type="user">
    <result property="userId"       column="user_id"      jdbcType="VARCHAR"/>
    <result property="userName" column="user_name"    jdbcType="VARCHAR" />
    <result property="password"   column="password"     jdbcType="VARCHAR" />
    <result property="role"         column="role"           jdbcType="VARCHAR" />
    <result property="ssn"        column="ssn"          jdbcType="VARCHAR" />
    <result property="phone"      column="cell_phone"     jdbcType="VARCHAR" />
    <result property="addr"         column="addr"           jdbcType="VARCHAR" />
    <result property="email"      column="email"        jdbcType="NUMERIC"  />
    <result property="regDate"    column="reg_date"       jdbcType="DATE" />
  </resultMap>
   -->
    <resultMap id="artistSelectMap" type="artist">
    <result property="artistNo"    column="artist_no"      jdbcType="NUMERIC"/>
    <result property="artistName"   column="artist_name"      jdbcType="VARCHAR"/>
    <result property="genre"   column="genre"     jdbcType="VARCHAR" />
    <result property="music"      column="music"        jdbcType="VARCHAR"  />
    <result property="image"   column="image"   jdbcType="VARCHAR"  />
    <result property="introduce"   column="introduce"   jdbcType="VARCHAR"  />
    
  </resultMap>
  <!-- SQL : INSERT -->
  <insert   id="addArtist"    parameterType="artist" >
    INSERT
    INTO artists( artist_no,artist_name,genre,music,image,introduce) 
    VALUES   (seq_artist_artistno.NEXTVAL,  #{artistName} ,  #{genre} , #{music} , 
             #{image}, #{introduce} )
   </insert>
   
   
   <select  id="getArtist"  parameterType="int"  resultMap="artistSelectMap">
    SELECT
    artist_no,artist_name,genre,music,image,introduce    
    FROM artists 
    WHERE ARTIST_NO = #{value}
   </select>
 
      
   <select id= "getTotalCount" resultType="int">
    SELECT COUNT(*)
    FROM artists
   </select>
   
   <select  id="getArtistList"  resultMap="artistSelectMap" >
		  SELECT*FROM artists ORDER BY artist_no DESC
   </select>

   
   <!-- SQL : UPDATE -->
   <!--  
   <update  id="updateUser" parameterType="user" >
      UPDATE users
      <set>
        user_name   = #{userName} ,
      cell_phone  = #{phone},
      addr        = #{addr} ,
      email       = #{email}
      </set>
      WHERE user_id = #{userId}
   </update>
     -->
  <!-- SQL : SELECT LIST -->
    <!-- 
  <select  id="getUserList"  parameterType="search" resultMap="userSelectMap">
      SELECT *
      FROM (  SELECT inner_table.* , ROWNUM AS row_seq
              FROM    ( SELECT user_id , user_name , email
                      FROM users
                      <if test="searchCondition != null">
                        <where>
                          <if test="searchCondition == 0 and searchKeyword !='' ">
                            user_id like &apos;${searchKeyword}%&apos;
                          </if>
                          <if test="searchCondition == 1 and searchKeyword !='' ">
                            user_name like &apos;${searchKeyword}%&apos;
                          </if>
                        </where>
                      </if>
                      ORDER BY user_id ) inner_table
            WHERE ROWNUM &lt;= #{endRowNum} )
    WHERE row_seq BETWEEN #{startRowNum} AND #{endRowNum} 
   </select>
-->
    <!--  위 두번째 subQuery 의  
        WHERE ROWNUM &lt;= #{endRowNum} ) 는
        WHERE ROWNUM <= #{endRowNum} ) 의미이며..
        < 는 keyword 로 &lt; 를  사용.
        
        <![CDATA[  ~~~  ]]> 를 이용하여 아래와 같이 사용  할 수 있다.
        CDATA ==> Character Data 의 의미 Java 에서 \n 같은 특수문자 처리  

        WHERE ROWNUM <![CDATA[ <=]]> #{endRowNum} )
    -->
  
  <!-- SQL : SELECT ROW Count -->  
  <!--  
   <select  id="getTotalCount"  parameterType="search"   resultType="int">
      SELECT COUNT(*)
      FROM( SELECT user_id , user_name , email
            FROM users
            <if test="searchCondition != null">
              <where>
                <if test="searchCondition == 0 and searchKeyword !='' ">
                  user_id like &apos;${searchKeyword}%&apos;
                </if>
                <if test="searchCondition == 1 and searchKeyword !='' ">
                user_name like '${searchKeyword}%&apos;
                </if>
              </where>
            </if> ) countTable            
   </select>
   -->

</mapper>